var refreshPeriod = 120; // 120 Seconds function refresh() { document.cookie = 'scrollTop='   filterScrollTop(); document.cookie = 'scrollLeft='   filterScrollLeft(); document.location.reload(true); } function getCookie(name) { var start = document.cookie.indexOf(name   "="); var len = start   name.length   1; if(((!start) && (name != document.cookie.substring(0, name.length))) || start == -1) return null; var end = document.cookie.indexOf(";", len); if(end == -1) end = document.cookie.length; return unescape(document.cookie.substring(len, end)); } function deleteCookie(name) { document.cookie = name   "="   ";expires=Thu, 01-Jan-1970 00:00:01 GMT"; } function setupRefresh() { var scrollTop = getCookie("scrollTop"); var scrollLeft = getCookie("scrollLeft"); if (!isNaN(scrollTop)) { document.body.scrollTop = scrollTop; document.documentElement.scrollTop = scrollTop; } if (!isNaN(scrollLeft)) { document.body.scrollLeft = scrollLeft; document.documentElement.scrollLeft = scrollLeft; } deleteCookie("scrollTop"); deleteCookie("scrollLeft"); setTimeout("refresh()", refreshPeriod * 1000); } function filterResults(win, docEl, body) { var result = win ? win : 0; if (docEl && (!result || (result > docEl))) result = docEl; return body && (!result || (result > body)) ? body : result; } // Setting the cookie for vertical position function filterScrollTop() { var win = window.pageYOffset ? window.pageYOffset : 0; var docEl = document.documentElement ? document.documentElement.scrollTop : 0; var body = document.body ? document.body.scrollTop : 0; return filterResults(win, docEl, body); } // Setting the cookie for horizontal position function filterScrollLeft() { var win = window.pageXOffset ? window.pageXOffset : 0; var docEl = document.documentElement ? document.documentElement.scrollLeft : 0; var body = document.body ? document.body.scrollLeft : 0; return filterResults(win, docEl, body); } function setCookie(name, value, expires, path, domain, secure){ if (!expires){expires = new Date()} document.cookie = name   "="   escape(value)   ((expires == null) ? "" : "; expires="   expires.toGMTString())   ((path == null) ? "" : "; path="   path)   ((domain == null) ? "" : "; domain="   domain)   ((secure == null) ? "" : "; secure") } function getCookie(name) { var arg = name   "=" var alen = arg.length var clen = document.cookie.length var i = 0 while (i < clen) { var j = i   alen if (document.cookie.substring(i, j) == arg){ return getCookieVal(j) } i = document.cookie.indexOf(" ", i)   1 if (i == 0) break } return null } function getCookieVal(offset){ var endstr = document.cookie.indexOf (";", offset) if (endstr == -1) endstr = document.cookie.length return unescape(document.cookie.substring(offset, endstr)) } function deleteCookie(name,path,domain){ document.cookie = name   "="   ((path == null) ? "" : "; path="   path)   ((domain == null) ? "" : "; domain="   domain)   "; expires=Thu, 01-Jan-00 00:00:01 GMT" } function saveScroll(){ // added function var expdate = new Date () expdate.setTime (expdate.getTime()   (expdays*24*60*60*1000)); // expiry date var x = (document.pageXOffset?document.pageXOffset:document.body.scrollLeft) var y = (document.pageYOffset?document.pageYOffset:document.body.scrollTop) Data=x   "_"   y setCookie(cookieName,Data,expdate) } function setupRefresh(){ // added function inf=getCookie(cookieName) if(!inf){return} var ar = inf.split("_") if(ar.length == 2){ window.scrollTo(parseInt(ar[0]), parseInt(ar[1])) } } // add
